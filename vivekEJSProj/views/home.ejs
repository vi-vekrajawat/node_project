<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <style>
        .container1 {
    display: grid;
    grid-template-columns: auto auto auto ; 
    gap: 20px; 
    padding: 20px;
    
   
}
#inside-div {
    box-shadow: 10px 10px 10px grey;
    background-color: #f9f9f9;
    text-align: center;
}
@keyframes zoomEffect {
  0% {
    transform: scale(1);
  }
  100% {
    transform: scale(1.02);
  }
}
#inside-div:hover {
  animation: zoomEffect 0.3s ease-in-out forwards;
}

#inside-div a {
    display: block;
    background-color: orange;
    color: white;
    text-align: center;
    padding: 8px;
    text-decoration: none;
}.carousel {
  height: 350px;
  overflow: hidden;
}

.carousel-inner {
  height: 100%;
}

.carousel-item img {
  object-fit: fill;
}

#carouselExampleInterval {
  width: 1222px; 
  margin: 0 auto; 
}


    </style>
</head>
<body>
  <% if (isLoggedIn) { %>
    <%-include("__navbar.ejs")%>

    <div id="carouselExampleInterval" class="carousel slide" data-bs-ride="carousel">
  <div class="carousel-inner">
    <div class="carousel-item active" data-bs-interval="10000">
      <img src="https://www.realsimple.com/thmb/B_DuwyqJ4gS5GZP9uckHZIlZbG4=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/RS1224DINN_0665_Spiced-Lamb-Tacos_preview-f20fd405e6b64343944ed30e15adf64b.jpg" height="350px" class="d-block w-100" alt="...">
    </div>
    <div class="carousel-item" data-bs-interval="2000">
      <img src="https://simplegreenmoms.com/wp-content/uploads/2021/10/groundbeef-tacos-with-jalapenos-in-white-dish.jpg"  height="350px" class="d-block w-100" alt="...">
    </div>
    <div class="carousel-item">
      <img src="https://cdn.apartmenttherapy.info/image/fetch/f_auto,q_auto:eco,c_fill,g_auto,w_800,h_400/https%3A%2F%2Fs3.amazonaws.com%2Fpixtruder%2Foriginal_images%2Ff5cffedb779ce8ea3991f8020b5616d39ef6c0ee"  height="350px" class="d-block w-100" alt="...">
    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>

     <div class="container1">   
  <% for (let product of products) { %>
    <div id="inside-div">
      <img src="<%= product.image %>" width="100%" height="200px" />
      <p><b><%= product.name %></b></p>
      <p><b style="color: green; font-size: large;"><%= product.price %>Rs.</b></p>
      <a href="/product/<%= product.id %>">View more</a>
    </div>
  <% } %>
 
</div>
 <% } else{%>
   <h2 style="text-align:center; margin-top: 40px;">Please <a href="/login">log in</a> to view products.</h2>
<% } %>
<%-include("__footer.ejs")%>

<script>
const searchForm = document.getElementById('searchForm');
const searchInput = document.getElementById('searchInput');
const container = document.querySelector('.container1');

searchForm.addEventListener('submit', async (e) => {
    e.preventDefault(); 
    const query = searchInput.value.trim();
    if (!query) return;

    try {
        const res = await fetch(`/search?q=${encodeURIComponent(query)}`);
        const data = await res.json(); 

        container.innerHTML = '';

        if (data.products.length === 0) {
            container.innerHTML = '<p>No products found.</p>';
            return;
        }

        data.products.forEach(product => {
            const div = document.createElement('div');
            div.id = 'inside-div';
            div.innerHTML = `
                <img src="${product.image}" width="100%" height="200px" />
                <p><b>${product.name}</b></p>
                <p><b style="color: green; font-size: large;">${product.price}Rs.</b></p>
                <a href="/product/${product.id}">View more</a>
            `;
            container.appendChild(div);
        });
    } catch (err) {
        console.error(err);
    }
});
</script>

</body>
</html>


